<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DANIBOOM WEB | Principal</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Orbitron',sans-serif}
body{background:#0b0b0b;color:#fff}

/* HEADER */
header{
  position:fixed;top:0;width:100%;z-index:1000;
  display:flex;justify-content:space-between;align-items:center;
  padding:1rem 2rem;background:rgba(0,0,0,.5);
  backdrop-filter:blur(10px);
}
.logo{display:flex;align-items:center;gap:1rem}
.logo img{width:50px;height:50px;border-radius:50%;border:2px solid gold}
.logo span{
  font-family:'Press Start 2P';
  font-size:.85rem;color:#ffd700;
  text-shadow:0 0 8px gold,0 0 20px gold;
}

/* MENU */
.menu-btn{width:26px;display:flex;flex-direction:column;gap:5px;cursor:pointer}
.menu-btn span{height:3px;background:gold;border-radius:3px}
.menu-popup{
  position:absolute;top:60px;right:0;
  background:#111;border:2px solid gold;border-radius:14px;
  padding:1rem;display:none;flex-direction:column;
  min-width:260px;gap:.6rem;
}

/* PERFIL */
.profile-box{
  background:#222;border:2px solid gold;border-radius:14px;
  padding:1rem;display:flex;flex-direction:column;
  align-items:center;gap:.4rem;
}
.profile-pic{
  width:60px;height:60px;border-radius:50%;
  border:2px solid gold;background:#000;
}
.profile-name{font-weight:700}

/* ROLES TEXTO */
.role-anon{color:#666}
.role-sub{color:#ffd700;text-shadow:0 0 8px #ffd700}
.role-admin{color:#ff9800;text-shadow:0 0 8px #ff9800}
.role-owner{color:#ff0000;text-shadow:0 0 10px #ff0000}

/* ===== INSIGNIAS HTML ===== */
.badge{width:20px;height:20px;display:inline-block}

/* ANÓNIMO (usuario) */
.badge-anon{
  position:relative;
}
.badge-anon::before{
  content:"";position:absolute;
  width:8px;height:8px;
  background:#666;border-radius:50%;
  top:0;left:6px;
}
.badge-anon::after{
  content:"";position:absolute;
  width:14px;height:8px;
  background:#666;border-radius:6px 6px 0 0;
  bottom:0;left:3px;
}

/* SUSCRIPTOR (estrella) */
.badge-sub{
  clip-path:polygon(
    50% 0%,61% 35%,98% 35%,68% 57%,
    79% 91%,50% 70%,21% 91%,32% 57%,
    2% 35%,39% 35%
  );
  background:#ffd700;
  box-shadow:0 0 10px #ffd700;
}

/* ADMIN (escudo) */
.badge-admin{
  clip-path:polygon(
    20% 0%,80% 0%,100% 30%,50% 100%,0% 30%
  );
  background:#ff9800;
  box-shadow:0 0 10px #ff9800;
}

/* DUEÑO (corona) */
.badge-owner{
  clip-path:polygon(
    0% 100%,10% 40%,30% 60%,50% 30%,
    70% 60%,90% 40%,100% 100%
  );
  background:#ff0000;
  box-shadow:0 0 12px #ff0000;
}

/* BOTONES */
.profile-buttons{display:flex;width:100%;gap:.4rem}
.profile-buttons button{
  flex:1;padding:.4rem;border:none;border-radius:10px;
  background:gold;color:#000;font-weight:700;cursor:pointer;
}

/* ADMIN UTILS */
#adminUtils{
  display:none;width:100%;
  border:2px solid red;border-radius:12px;
  padding:.5rem;background:#111;
}
#adminUtils h3{
  color:red;text-align:center;font-size:.85rem;margin-bottom:.3rem;
}
#adminUtils button{
  width:100%;padding:.4rem;border:none;border-radius:8px;
  background:red;color:white;font-weight:700;
}

/* LINKS */
.menu-texts{
  display:flex;flex-direction:column;
  align-items:flex-start;gap:.4rem;
}
.menu-texts span{
  cursor:pointer;color:#ffd700;
  font-weight:700;text-decoration:underline;
}

/* MAIN */
main{padding:140px 2rem}
.title{text-align:center;font-size:2.2rem;color:#ffd700}
.desc{text-align:center;color:#aaa;margin-top:.5rem}
</style>
</head>

<body>

<header>
  <div class="logo">
    <img src="logo.png">
    <span>DANIBOOM WEB</span>
  </div>

  <div style="position:relative">
    <div class="menu-btn" id="menuBtn"><span></span><span></span><span></span></div>

    <div class="menu-popup" id="menuPopup">

      <div class="profile-box">
        <div id="profilePic" class="profile-pic"></div>

        <p id="profileName" class="profile-name"></p>

        <div style="display:flex;align-items:center;gap:.4rem">
          <div id="roleBadge" class="badge"></div>
          <span id="profileRole"></span>
        </div>

        <div class="profile-buttons" id="profileButtons"></div>

        <div id="adminUtils">
          <h3>Admin Utils</h3>
          <button onclick="location.href='notificaciones.html'">Notificaciones</button>
        </div>
      </div>

      <div class="menu-texts">
        <span id="redesLink">Redes</span>
        <span id="sensLink">Sensibilidades</span>
        <span id="appsLink">Aplicaciones Pro</span>
      </div>

    </div>
  </div>
</header>

<main>
  <h1 class="title">Bienvenido</h1>
  <p class="desc">Zona oficial DaniBoom</p>
</main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

initializeApp({
  apiKey:"AIzaSyChOQg743fsmGK89KVLoNAri_VGklArRi4",
  authDomain:"web1-3b83a.firebaseapp.com",
  projectId:"web1-3b83a"
});

const auth = getAuth();
const db = getFirestore();

menuBtn.onclick=()=>menuPopup.style.display=
  menuPopup.style.display==="flex"?"none":"flex";

onAuthStateChanged(auth, async user=>{
  if(!user){location.href="index.html";return;}

  const snap=await getDoc(doc(db,"users",user.uid));
  if(!snap.exists())return;

  const d=snap.data();

  const roles={
    anonymous:{name:"Anónimo",cls:"role-anon",badge:"badge-anon"},
    suscriptor:{name:"Suscriptor",cls:"role-sub",badge:"badge-sub"},
    admin:{name:"Admin",cls:"role-admin",badge:"badge-admin"},
    owner:{name:"Dueño",cls:"role-owner",badge:"badge-owner"}
  };

  const r=roles[d.membership];

  profileName.textContent=d.displayName;
  profileRole.textContent=r.name;
  profileRole.className=r.cls;
  roleBadge.className="badge "+r.badge;

  redesLink.style.display="none";
  sensLink.style.display="none";
  appsLink.style.display="none";
  adminUtils.style.display="none";

  if(d.membership==="anonymous"){
    redesLink.style.display="block";
    profileButtons.innerHTML=
      `<button onclick="location.href='index.html'">Iniciar sesión</button>`;
  }else{
    redesLink.style.display="block";
    sensLink.style.display="block";
    appsLink.style.display="block";

    profileButtons.innerHTML=
      `<button onclick="location.href='rede.html'">Perfil</button>
       <button id="logoutBtn">Salir</button>`;

    if(d.membership==="admin"||d.membership==="owner"){
      adminUtils.style.display="block";
    }

    document.getElementById("logoutBtn").onclick=
      ()=>signOut(auth).then(()=>location.href="index.html");
  }
});

redesLink.onclick=()=>location.href="rede.html";
sensLink.onclick=()=>location.href="sensibilidades.html";
appsLink.onclick=()=>location.href="aplicaciones.html";
</script>

</body>
</html>
